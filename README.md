# ModuleLLM_MAniaX

「ModuleLLM_MAniaX 」のサポートページです。

## 紹介
Module-LLMはAxera-techのAX630CというSoCを搭載しており、M5Stackにスタックすることができるコンパクトなサイズにも関わらず、LLM（Large Language Models、大規模言語モデル）を動かすことができる非常に面白いデバイスです。LLMだけではなく、画像処理のCNNやTransformerを使ったモデルや、音声合成・音声認識のモデルをパラフルなNPUで高速に動かすことができます。
本書には、Module-LLMの基本的な使い方から、Module-LLMのパワフルなNPUを使った画像処理の実践まで、Module-LLMを活用するための情報が豊富に含まれています。

## 目次
目次
第1 章Module-LLM の紹介7
1.1 M5Stack Module-LLM とは. . . . . . . . . . . . . . . . . . . . 7
1.2 M5Stack LLM630 Compute Kit とは. . . . . . . . . . . . . . 8
1.3 M5Stack とは. . . . . . . . . . . . . . . . . . . . . . . . . . . 9
1.4 AXERA 社とは. . . . . . . . . . . . . . . . . . . . . . . . . . . 10
1.5 AXERA AX630C とは. . . . . . . . . . . . . . . . . . . . . . 12
第2 章Module-LLM をつかってみよう13
2.1 Module-LLM とデバッグボードを繋ぐ. . . . . . . . . . . . . . . 13
2.1.1 Module-LLM とデバッグボードの接続方法. . . . . . . . 13
2.2 ADB ツールを使ってログインする. . . . . . . . . . . . . . . . . 18
2.3 Module-LLM でL チカ. . . . . . . . . . . . . . . . . . . . . . 20
2.3.1 Module-LLM のLED の役割. . . . . . . . . . . . . . . 20
2.3.2 L チカをしてみる. . . . . . . . . . . . . . . . . . . . . . 20
2.3.3 Python からLED を制御する. . . . . . . . . . . . . . . 21
2.4 Module-LLM の起動音の消し方. . . . . . . . . . . . . . . . . . 22
2.4.1 起動音の消し方. . . . . . . . . . . . . . . . . . . . . . . 22
2.5 Module-LLM へファイル転送. . . . . . . . . . . . . . . . . . . 23
2.5.1 SCP でファイル転送. . . . . . . . . . . . . . . . . . . . 23
2.5.2 SCP でファイル転送① (PC → Module-LLM) . . . . . . . 23
2.5.3 SCP でファイル転送② (PC → Module-LLM) . . . . . . . 24
2.5.4 SCP でファイル転送(Module-LLM → PC) . . . . . . . . 25
2.6 Samba で共有フォルダを作る. . . . . . . . . . . . . . . . . . . 25
2.7 メモリが足りない場合の対処. . . . . . . . . . . . . . . . . . . . 28
2.7.1 現在のメモリ容量の確認. . . . . . . . . . . . . . . . . . 28
2.7.2 OS とNPU のメモリの割当を変更する. . . . . . . . . . . 30
2.7.3 スワップメモリ設定手順. . . . . . . . . . . . . . . . . . 33
2.8 ファームウェアの更新手順. . . . . . . . . . . . . . . . . . . . . 36
2.9 WSL2 のインストール. . . . . . . . . . . . . . . . . . . . . . . 40
2.9.1 インストール手順. . . . . . . . . . . . . . . . . . . . . . 40
2.9.2 初期設定. . . . . . . . . . . . . . . . . . . . . . . . . . 41
2.9.3 動作確認とアップデート. . . . . . . . . . . . . . . . . . 41
2.9.4 トラブルシューティング. . . . . . . . . . . . . . . . . . 41
2.9.5 Python 環境のインストール. . . . . . . . . . . . . . . . 41
第3 章StackFlow を使ってみよう43
3.1 StackFlow とは？ . . . . . . . . . . . . . . . . . . . . . . . . . 43
3.2 StackFlow のdeb パッケージについて. . . . . . . . . . . . . . . 44
3.3 StackFlow の起動と停止. . . . . . . . . . . . . . . . . . . . . . 44
3.4 StackFlow のインストール. . . . . . . . . . . . . . . . . . . . . 47
3.5 StackFlow をPython から使ってみよう. . . . . . . . . . . . . . 49
3.5.1 Module-LLM でpython を使う場合. . . . . . . . . . . . 49
3.6 StackFlow のllm-sys ユニットとは？ . . . . . . . . . . . . . . . 50
3.6.1 llm-sys ユニットから情報を取得する. . . . . . . . . . . . 52
3.7 StackFlow からリセットをかける. . . . . . . . . . . . . . . . . 54
3.8 StackFlow からLinux コマンド実行. . . . . . . . . . . . . . . . 56
3.9 StackFlow でLLM の推論をする. . . . . . . . . . . . . . . . . 59
3.10 StackFlow でMeloTTS から発音を行う. . . . . . . . . . . . . . 63
3.11 StackFlow でWhisper から音声認識. . . . . . . . . . . . . . . 67
3.12 StackFlow をビルドするには. . . . . . . . . . . . . . . . . . . . 73
第4 章Python でNPU 推論74
4.1 PyAXEngine とは？ . . . . . . . . . . . . . . . . . . . . . . . 74
4.2 PyAXEngine のインストール. . . . . . . . . . . . . . . . . . . 74
4.3 MobileNetV2 の推論. . . . . . . . . . . . . . . . . . . . . . . . 75
4.4 YOLO11 の推論. . . . . . . . . . . . . . . . . . . . . . . . . . 79
4.5 DepthAnything の推論. . . . . . . . . . . . . . . . . . . . . . . 85
4.6 USB カメラからの動画取得. . . . . . . . . . . . . . . . . . . . . 88
4.6.1 Module-LLM のType-C ポートについて. . . . . . . . . 88
4.6.2 画像のストリーミング配信. . . . . . . . . . . . . . . . . 89
4.7 USB カメラからのDepthAnything 推論. . . . . . . . . . . . . . 91
第5 章C++ でNPU 推論95
5.1 C++ 開発環境の準備. . . . . . . . . . . . . . . . . . . . . . . . 95
5.2 ライブラリのインストール. . . . . . . . . . . . . . . . . . . . . 95
5.2.1 クロスコンパイラのインストール. . . . . . . . . . . . . . 95
5.2.2 AX620Q BSP SDK のダウンロード. . . . . . . . . . . . 96
5.2.3 ax-samples のダウンロード. . . . . . . . . . . . . . . . 97
5.2.4 OpenCV-Mobile のダウンロード. . . . . . . . . . . . . 97
5.3 DepthAnything の推論プログラムの作成. . . . . . . . . . . . . 98
5.4 USB カメラの画像をストリーミング配信する. . . . . . . . . . . 104
5.5 USB カメラからのDepthAnything 推論. . . . . . . . . . . . . . 107
5.6 ax-samples のCV サンプルのビルド手順. . . . . . . . . . . . . 112
5.6.1 AX620E BSP SDK のダウンロードとパスの設定. . . . . 113
5.7 OpenCV-Mobile のビルド手順. . . . . . . . . . . . . . . . . . . 115
第6 章Pulsar2 でモデル変換117
6.1 量子化とは？ . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
6.2 Pulsar2 ToolChain の概要. . . . . . . . . . . . . . . . . . . . . 120
6.2.1 Docker 開発環境のインストール. . . . . . . . . . . . . . 120
6.3 Pulsar2 のインストール. . . . . . . . . . . . . . . . . . . . . . 122
6.3.1 Docker イメージのロード. . . . . . . . . . . . . . . . . . 122
6.3.2 Docker コンテナの起動手順. . . . . . . . . . . . . . . . 123
6.3.3 バージョンの確認. . . . . . . . . . . . . . . . . . . . . . 124
6.3.4 Pulsar2 のコマンド. . . . . . . . . . . . . . . . . . . . . 124
6.4 ライブラリのインストール. . . . . . . . . . . . . . . . . . . . . 125
6.5 サンプルデータのダウンロード. . . . . . . . . . . . . . . . . . . 125
6.6 MobileNetV2 モデルの変換. . . . . . . . . . . . . . . . . . . . 126
6.6.1 MobileNetV2 モデルのダウンロード. . . . . . . . . . . . 126
6.6.2 MobileNetV2 モデル変換. . . . . . . . . . . . . . . . . 127
6.7 YOLO11 モデルの変換. . . . . . . . . . . . . . . . . . . . . . . 128
6.7.1 YOLO11n モデルのダウンロード. . . . . . . . . . . . . 129
6.7.2 YOLO11 ONNX モデルの加工. . . . . . . . . . . . . . 129
6.7.3 YOLO11 モデルを変換する. . . . . . . . . . . . . . . . 131
6.8 行列計算モデルの変換. . . . . . . . . . . . . . . . . . . . . . . . 133
6.9 Pulsar2 が対応しているONNX オペレータ. . . . . . . . . . . . 141
第7 章Pulsar2 でLLM モデルを変換143
7.1 TinySwallow-1.5B とは？ . . . . . . . . . . . . . . . . . . . . . 144
7.2 huggingface_hub のインストール. . . . . . . . . . . . . . . . . 144
7.3 TinySwallow-1.5B モデルのダウンロード. . . . . . . . . . . . . 146
7.3.1 StackFlow でのLLM 推論実行準備. . . . . . . . . . . . 149
7.3.2 StackFlow でのLLM 推論実行. . . . . . . . . . . . . . . 151

Copyright (c) 2025 aNoken

